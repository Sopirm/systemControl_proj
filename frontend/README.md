# Клиентская часть (Frontend) «СистемаКонтроля»

Фронтенд системы построен на Vue 3 с использованием TypeScript и Vite.

## Технологический стек

- **Vue.js 3** - основной фреймворк
- **TypeScript** - типизация JavaScript
- **Vite** - инструмент сборки
- **Vue Router** - маршрутизация
- **Composables** - переиспользуемая бизнес-логика
- **ESLint** - линтер для проверки кода

## Структура проекта

```
frontend/
├── public/              # Статические файлы
├── src/                 # Исходный код
│   ├── assets/          # Ресурсы (CSS, изображения)
│   ├── components/      # Vue компоненты
│   │   ├── AppHeader.vue      # Заголовок приложения
│   │   ├── BaseButton.vue     # Кнопка
│   │   ├── BaseCard.vue       # Карточка
│   │   ├── BaseInput.vue      # Поле ввода
│   │   ├── BaseSelect.vue     # Выпадающий список
│   │   └── DefectItem.vue     # Элемент дефекта
│   ├── composables/     # Переиспользуемая логика
│   │   └── useAuth.ts         # Хук для работы с авторизацией
│   ├── router/          # Маршрутизация
│   │   └── index.ts           # Конфигурация маршрутов
│   ├── services/        # API-сервисы
│   │   ├── api.ts             # Основной API-сервис
│   │   └── userService.ts     # Сервис для работы с пользователями
│   ├── stores/          # Хранилище данных
│   └── views/           # Страницы приложения
│       ├── DefectDetailView.vue    # Детали дефекта
│       ├── DefectsView.vue         # Список дефектов
│       ├── HomeView.vue            # Главная страница
│       ├── LoginView.vue           # Страница входа
│       ├── ProjectDetailView.vue   # Детали проекта
│       ├── ProjectsView.vue        # Список проектов
│       ├── RegisterView.vue        # Регистрация
│       ├── ReportsView.vue         # Отчеты
│       └── UsersView.vue           # Управление пользователями
├── .editorconfig        # Настройки редактора
├── .gitattributes       # Настройки Git
├── .gitignore           # Игнорируемые файлы
├── .prettierrc.json     # Настройки форматирования кода
├── env.d.ts             # Типы для переменных окружения
├── eslint.config.ts     # Конфигурация ESLint
├── index.html           # Точка входа HTML
├── package-lock.json    # Фиксация версий зависимостей
├── package.json         # Зависимости и скрипты
├── playwright.config.ts # Конфигурация E2E тестов
├── tsconfig.app.json    # Конфигурация TypeScript для приложения
├── tsconfig.json        # Основная конфигурация TypeScript
├── tsconfig.node.json   # Конфигурация TypeScript для Node.js
├── tsconfig.vitest.json # Конфигурация TypeScript для тестов
├── vite.config.ts       # Конфигурация сборщика Vite
└── vitest.config.ts     # Конфигурация unit-тестов
```

## Основные функциональные блоки

### Аутентификация и авторизация
- Регистрация пользователей с выбором роли
- Вход по имени пользователя или email
- Защита маршрутов на основе статуса авторизации
- Управление доступом на основе ролей

### Управление пользователями
- Просмотр списка пользователей (для менеджеров)
- Изменение ролей пользователей (для менеджеров)

### Управление проектами
- Просмотр списка проектов
- Создание, редактирование и удаление проектов

### Управление дефектами
- Просмотр списка дефектов
- Создание, редактирование и удаление дефектов
- Изменение статуса дефектов

### Отчетность
- Диаграммы по дефектам: по статусам, приоритетам и объектам (Chart.js)
- Общий отчет (проекты + дефекты):
  - Полная локализация на русский язык (заголовки, статусы, приоритеты)
  - Горизонтальная прокрутка таблицы без выхода за экран
  - Экспорт в CSV и Excel (имена файлов на русском)
  - Формат времени: `YYYY-MM-DD HH:MM:SS`
  - ФИО для менеджера, автора и исполнителя
- Доступ к разделу «Отчеты»: роли `manager` и `observer` (см. `src/router/index.ts`)

## Запуск проекта

### Установка зависимостей

```bash
npm install
```

### Запуск сервера разработки

```bash
npm run dev
```

После запуска приложение будет доступно по адресу [http://localhost:5173](http://localhost:5173)

### Экспорт Excel

Для экспорта в Excel используется библиотека `xlsx` (динамический импорт). Если не установлено:

```bash
npm i xlsx
```

### Сборка для продакшн

```bash
npm run build
```

### Запуск Unit-тестов

```bash
npm run test:unit
```

### Запуск E2E тестов

```bash
# Установка браузеров при первом запуске
npx playwright install

# Запуск всех тестов
npm run test:e2e

# Запуск тестов только в Chromium
npm run test:e2e -- --project=chromium

# Запуск конкретного теста
npm run test:e2e -- tests/example.spec.ts

# Запуск тестов в режиме отладки
npm run test:e2e -- --debug
```

### Запуск линтера

```bash
npm run lint
```

## Взаимодействие с backend API

Для взаимодействия с API бэкенда используются сервисы из директории `src/services/`. В продакшн окружении необходимо настроить прокси в Nginx или другом веб-сервере для корректного перенаправления запросов к API.

### Конфигурация прокси в режиме разработки

В файле `vite.config.ts` настроено проксирование запросов для разработки:

```typescript
server: {
  proxy: {
    '/api': {
      target: 'http://localhost:8080',
      changeOrigin: true,
      secure: false
    },
    '/auth': {
      target: 'http://localhost:8080',
      changeOrigin: true,
      secure: false
    },
    '/debug': {
      target: 'http://localhost:8080',
      changeOrigin: true,
      secure: false
    }
  }
}
```