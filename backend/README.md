# Серверная часть (Backend) «СистемаКонтроля»

Бэкенд системы построен на языке Go с использованием фреймворка Gin.

## Технологический стек

- **Go (Golang)** - основной язык программирования
- **Gin Framework** - веб-фреймворк для создания API
- **GORM** - ORM для работы с базой данных
- **PostgreSQL** - реляционная база данных
- **JWT** - система авторизации на основе токенов

## Структура проекта

```
backend/
├── config/          # Конфигурация приложения
├── controllers/     # Обработчики запросов
├── database/        # Подключение и настройка БД
├── middleware/      # Промежуточные обработчики
├── models/          # Модели данных
├── routes/          # Настройка маршрутов
├── .env             # Переменные окружения (не в репозитории)
├── .env.example     # Пример файла переменных окружения
├── go.mod           # Зависимости Go
├── go.sum           # Проверочные суммы зависимостей
└── main.go          # Точка входа в приложение
```

## Модели данных

В системе определены следующие модели данных:

- **User** - информация о пользователях системы
- **Project** - информация о проектах/строительных объектах
- **Defect** - информация о дефектах на объектах
- **Comment** - комментарии к дефектам

## API Endpoints

### Аутентификация

- `POST /auth/register` - регистрация нового пользователя
- `POST /auth/login` - вход в систему

### API (требуется авторизация)

- `GET /api/profile` - получение профиля пользователя

#### Проекты

- `GET /api/projects` - список всех проектов
- `GET /api/projects/:id` - информация о проекте
- `POST /api/projects` - создание проекта (только менеджер)
- `PUT /api/projects/:id` - обновление проекта (только менеджер)
- `DELETE /api/projects/:id` - удаление проекта (только менеджер)

#### Дефекты

- `GET /api/defects` - список всех дефектов
- `GET /api/defects/:id` - информация о дефекте
- `POST /api/defects` - создание дефекта
- `PUT /api/defects/:id` - обновление дефекта
- `DELETE /api/defects/:id` - удаление дефекта (только менеджер или инженер)

#### Комментарии

- `GET /api/defects/:defect_id/comments` - получение комментариев к дефекту
- `POST /api/defects/comments` - создание комментария
- `DELETE /api/defects/comments/:id` - удаление комментария (только автор или менеджер)

## Запуск проекта

### Предварительные требования

- Go 1.21 или выше
- PostgreSQL 13 или выше

### Настройка

1. Скопируйте `.env.example` в `.env` и настройте переменные окружения:
   ```bash
   cp .env.example .env
   ```

2. Создайте базу данных в PostgreSQL:
   ```sql
   CREATE DATABASE systemcontrol;
   ```

3. Установите зависимости:
   ```bash
   go mod tidy
   ```

4. Запустите приложение:
   ```bash
   go run main.go
   ```

Сервер будет запущен на `http://localhost:8080` (или порт, указанный в `.env`)
